function read_abundances, time,Temp,Y,dYdt

fdata = 'abundance.binary.dat' ;name of the abundance data file
ndata = 'number.binary.dat'   ;name of the file that has the number of lines
openr,1,ndata

n=0L
readu,1,n                      ;read in the number of lines
close, 1
openr,1,fdata
time=dblarr(n)
Temp=dblarr(n)
Y   =dblarr(n)
dYdt=dblarr(n)

t_temp=0.0D
Temp_temp=0.0D
Y_temp=0.0D
dYdt_temp=0.0D

I = 0L
for I=0,n-1 do begin
    readu,1,t_temp
    readu,1,Temp_temp
    readu,1,Y_temp
    readu,1,dYdt_temp
    time(i)=t_temp
    Temp(i)=Temp_temp
    Y(i)=Y_temp
    dYdt(i)=dYdt_temp
endfor

close,1
;print, n
return, n

end

pro main
n=read_abundances(a,b,c,d)
print, n
i=0L
for i=0,n-1 do begin
    print, a(i)
;    print, b(i)
;    print, c(i)
;    print, d(i)
endfor

end
